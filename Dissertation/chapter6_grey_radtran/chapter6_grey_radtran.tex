%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  New template code for TAMU Theses and Dissertations starting Fall 2012.  
%  For more info about this template or the 
%  TAMU LaTeX User's Group, see http://www.howdy.me/.
%
%  Author: Wendy Lynn Turner 
%	 Version 1.0 
%  Last updated 8/5/2012
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                           SECTION III
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\chapter{\uppercase{Grey Thermal Radiative Transfer}}
\label{sec:chapter6_grey_radtran}

We now apply our self-lumping DFEM methodology to the grey thermal radiative transfer equations.
Our framework will share important characteristics of the work presented by Morel, Wareing, and Smith\cite{morel_radtran}.
That is, we will
\begin{enumerate}
\item linearize the Planckian about an arbitrary temperature,
\item  expand the angular intensity and temperature in a $P$ degree trial space, and
\item expand the spatial dependence of the Planckian in a $P$ degree trial space.
\end{enumerate}
There are several differences between the work we present here and that of \cite{morel_radtran}.
First, we will derive our method for arbitrary DFEM polynomial trial space degree, not only a linear polynomial trial space.
Second, \cite{morel_radtran} used a DFEM scheme equivalent to traditional lumping, whereas we will primarily be considering quadrature based self-lumping discretizations.
However, the equations we derive will be applicable to any DFEM scheme that uses polynomial trial and test functions.
Additionally, we will consider arbitrary order (and stage count) SDIRK integration, not only implicit Euler time integration.
The two most important differences between our work here and that of \cite{morel_radtran} will be that we will assume opacity can vary within each spatial cell and we will fully converge the Planckian linearization in temperature.
As shown by Larsen, Kumar, and Morel, failure to fully converge the Planckian linearization in temperature can result lead to non-physical solutions that violate the maximum principle\cite{larsen_trt}.

The remainder of this chapter will be divided into three sections.  Section \ref{sec:chap6_linearization} will describe our linearization and discretization of grey TRT equations.  
In \secref{sec:chap6_programming}, we will briefly describe the features and computer science implementation of the discretized TRT equations.  
Finally, we present numerical results that verify and demonstrate the capabilities of our TRT solver in \secref{sec:chap6_results} and discuss the results in \secref{sec:chap6_conclusions}.

\section{Linearization and Discretization of Grey TRT Equations}
\label{sec:chap6_linearization}
We will begin our discussion of how to linearize the Planckian of the grey thermal radiative transfer in temperature by first briefly outlining SDIRK temporal integration in \secref{sec:sdirk_explained}.
A more complete explanation can be found in \cite{alexander}

\subsection{SDIRK Time Integration}
\label{sec:sdirk_explained}
The coefficients, $a_i$, $b_i$, and $c_i$ that describe any Runge-Kutta time integration are typically given in formatted tables called Butcher Tableaux.
Due to the stiff nature of the TRT equations, we will limit ourselves to SDIRK time integration schemes.  
Depending on the source, SDIRK stands for Single-Diagonally Implicit Runge-Kutta, S-stable Diagonally Implicit Runge-Kutta, or one of many other expansions of the SDIRK acronym, depending on the source's author.
The Butcher Tableaux of an SDIRK  scheme with $N_{stage}$ stages is given in \eqt{eq:butcher}
\benum
\label{eq:butcher}
\begin{array}{c|c|cccc}
\text{Stage}& c_i 	 & a  			&  		&					&	\\
\hline
1						&  c_1   &  a_{11} 	&  0  	&		\dots		&  0 \\
2						&  c_2   &  a_{21}  & a_{22}  & 		0		& \vdots	\\	
i						& c_i    &   a_{i1} &  a_{i2} & \ddots   &	0	\\
N_{stage}     			&  c_{N_{stage}}   &   a_{N_{stage}1} & a_{N_{stage}2} 	& \dots 		& a_{N_{stage}N_{stage} }\\
\hline
{}					&				&		b_1		&		b_2			& \dots 	&   b_{N_{stage}}
\end{array} \pep
\eenum
To illustrate how SDIRK is used to advance time dependent quantities, let us consider a time dependent scalar function, $g(t)$.
Given an initial value at time (or time step) $t^n$, $g_n = g(t^n)$, then $g(t^{n+1})$ is:
\benum
g_{n+1} = g_n + \Delta t \sum_{i=1}^{N_{tstage}}{b_i k_i} \pec
\label{eq:p1}
\eenum
where $\Delta t = t^{n+1} - t^n$, and $k_i$ is defined as:
\benum
k_i = f\left( t_n + c_i \Delta t ~,~g_{n} + \Delta t \sum_{j=1}^i{c_{ij} k_j }\right) \pec
\eenum
and
\benum
f(t,g) = \frac{\partial g}{\partial t} \pep
\eenum
Equation \ref{eq:p1} can also be interpreted as meaning:
\benum
g_i = g_{n} + \Delta t \sum_{j=1}^i{a_{ij} f\left(t_n + \Delta t c_j , g_j\right)} \pec
\label{eq:psi-def}
\eenum
where $g_i$ is the intermediate value of $g$ at the time of stage $i$, $t_i = t^n + \Delta t c_i$.

\subsection{Spatially Analytic Linearization}
%
%
We now linearize the spatially analytic, 1-D slab, grey, discrete ordinates TRT equations with SDIRK time integration.  The fully analytic grey TRT are given in \eqts{eq:analytic_grey_trt},
\begin{subequations}
\label{eq:analytic_grey_trt}
\benum
\frac{1}{c} \frac{\partial I}{\partial t} + \mu_d \frac{\partial I}{\partial x} + \sigma_t I= \frac{1}{4\pi}\sigma_s \phi + \sigma_a B + S_I
\label{eq:intensity_eq}
\eenum
\benum
C_v \frac{\partial T}{\partial t} = \sigma_a \left( \phi - 4\pi B \right) + S_T \pep
\label{eq:temperature_eq} 
\eenum
\end{subequations}
In \eqts{eq:analytic_grey_trt}, we have assumed all scattering and material photon emission is isotropic, assume that $I$ is the intensity with directional cosine $\mu_d$ (relative to the $x$-axis),  $S_I$ is a homogenous intensity source in the direction of $\mu_d$, $S_T$ is a homogenous temperature source, and the frequency integrated Planck, $B$ is:
\benum
B(T) = \frac{1}{4\pi} ac T^4\pec
\eenum
with $c$ as the speed of light, and $a$ is the Planck radiation constant.
To use SDIRK to advance $I$ and $T$ in time, we must first define the time derivatives of $I$ and $T$:
\benum
 \frac{\partial I}{\partial t} = c\left[ \frac{1}{4\pi}\sigma_s \phi + \sigma_a B + S_I - \mu_d \frac{\partial I}{\partial x} - \sigma_t I \right]
\label{eq:k_I}
\eenum
and
\benum
\frac{\partial T}{\partial t} = \frac{1}{C_v} \left[ \sigma_a \left( \phi - 4\pi B \right) + S_T \right] \pep
\label{eq:k_T}
\eenum
We evaluate $k_{I,s}$ and $k_{T,s}$, the SDIRK $k$ values for intensity and temperature for stage $s$ as:
\benum
k_{I,s} = c\left[ \frac{1}{4\pi}\sigma_{s}(T_s) \phi_s + \sigma_a(T_s) B(T_s) + S_I(t_s) - \mu_d \frac{\partial I_s}{\partial x} - \sigma_t(T_s) I_s \right]
\label{eq:k_I_stage}
\eenum
and
\benum
k_{T,s} = \frac{1}{C_v(T_s)} \left[ \sigma_a(T_s) \left( \phi_s - 4\pi B(T_s) \right) + S_T(t_s) \right] \pec
\label{eq:k_T_stage}
\eenum
where $\phi_s$, $I_s$, and $T_s$ are the angle integrated intensity, angular intensity, and temperature at stage/time $s$.

\subsubsection{SDIRK Stage 1}
With the definitions of \eqt{eq:psi-def}, \eqt{eq:k_I_stage}, and \eqt{eq:k_T_stage}, we now seek to find $I_1$,
\benum
I_1 = I_n + a_{11} \Delta t k_{I,1} \pec
\eenum
after substituting the definition of \eqt{eq:k_I_stage}
\benum
I_1 = I_n + a_{11} \Delta t c \left[ \frac{1}{4\pi}\sigma_{s} \phi_1 + \sigma_a B+ S_I - \mu_d \frac{\partial I_1}{\partial x} - \sigma_t I_1 \right] 
\pep
\label{eq:i_1_start}
\eenum
Likewise for $T_1$, we have
\benum
T_1 = T_n +\frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi B \right) + S_T  \right] \pep
\label{eq:t_1_start}
\eenum
In \eqt{eq:i_1_start} and \eqt{eq:t_1_start}, we have assumed that unless otherwise noted, all material properties and sources are evaluated at $t_s$ and $T_s$.

We now introduce the linearization of the Planckian in temperature. 
For an arbitrary temperature iterate, $T_*$, we approximate $B(T_s)$ as:
\beanum
B(T) &\approx & B(T_*) + \frac{\partial B}{\partial T} \bigg \lvert_{T=T_*} \left(  T - T_* \right) \\
B(T) &\approx & B_* + D_*  \left(  T - T_* \right) \\
D_* &=& \frac{1}{\pi} a cT_*^3 \pep
\label{eq:scalar_linear}
\eeanum
If we could remove the dependence on $T_1$ from \eqt{eq:i_1_start}, we could solve \eqt{eq:i_1_start} using the same techniques that have been developed to solve the discrete ordinates neutron transport equation.
To remove the dependence on $T_1$ from \eqt{eq:i_1_start}, we first insert the linearization of \eqt{eq:scalar_linear} into \eqt{eq:t_1_start} and manipulate.
We begin with \eqt{eq:long_t_1}
\benum
T_1 = T_n + \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi \left(  B_* + D_*  \left(  T_1 - T_* \right)  \right) \right) + S_T  \right] \pec
\label{eq:long_t_1}
\eenum
then move all $T_1$ terms to the left hand side,
\benum
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)T_1 = T_n + \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi   B_* + 4\pi D_*  T_* \right) + S_T  \right] \pep
\eenum
In \eqt{eq:long_t_1}, we have made the assumption that all material properties are evaluated at $T_*$, but will neglect to denote this for simpler notation.
Next, we divide by the coefficient in front of $T_1$ on the left hand side:
\begin{multline}
T_1 = \left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} T_n + \dots \\
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi   B_* \right) + S_T \right] + \dots \\
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{ 4\pi a_{11} \Delta t }{C_v} \sigma_a D_*  T_* \pec
\end{multline}
and then add ``nothing'' ,
\benum
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_* - T_* \right) \pec
\eenum
to the right hand side,
\begin{multline}
T_1 = \left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} T_n + \dots \\
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi   B_* \right) + S_T \right] + \dots \\
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left(1 + \frac{ 4\pi a_{11} \Delta t }{C_v} \sigma_a D_* \right) T_* \dots \\
-\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} T_*\pep
\end{multline}
Noting that 
\benum
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left(1 + \frac{ 4\pi a_{11} \Delta t }{C_v} \sigma_a D_* \right)  = 1 \pec
\eenum
and condensing, we finally have:
\benum
T_1 = T_* + \left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n - T_* + \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi   B_* \right) + S_T \right]  \right) \pep
\label{eq:analytic_t_1}
\eenum
We will occasionally refer to \eqt{eq:analytic_t_1} as a temperature update, as \eqt{eq:analytic_t_1} is the non-linear iteration for temperature we wish to converge.

We now linearize the Planck term in \eqt{eq:i_1_start},
\benum
I_1 = I_n + a_{11} \Delta t c \left[ \frac{1}{4\pi}\sigma_{s} \phi_1 + \sigma_a \left(B_* + D_*(T_1 - T_*)  \right) + S_I - \mu_d \frac{\partial I_1}{\partial x} - \sigma_t I_1 \right] \pep
\label{eq:long_i_1_analytic}
\eenum
We then insert \eqt{eq:analytic_t_1} into \eqt{eq:long_i_1_analytic},
\begin{multline}
I_1 = I_n + a_{11} \Delta t c \left[ \frac{1}{4\pi}\sigma_{s} \phi_1 + S_I - \mu_d \frac{\partial I_1}{\partial x} - \sigma_t I_1  \right. \\ 
\left. + \sigma_a \left(B_* + D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n - T_* + \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi   B_* \right) + S_T \right]  \right) \right) \right] \pep
\end{multline}
Next, we divide by $ a_{11} \Delta t c$, and move interaction and gradient terms to the left hand side:
\begin{multline}
\mu_d \frac{\partial I_1}{\partial x} + \sigma_t I_1 + \frac{1}{a_{11} \Delta t c} I_1 = \frac{1}{a_{11} \Delta t c}I_n + \frac{1}{4\pi}\sigma_{s} \phi_1 + S_I \dots \\
+ \sigma_a \left(B_* + D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n - T_* + \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi   B_* \right) + S_T \right]  \right) \right) \pep
\end{multline}
We now manipulate the right hand side,
\begin{multline}
\mu_d \frac{\partial I_1}{\partial x} + \sigma_t I_1 + \frac{1}{a_{11} \Delta t c} I_1 = \frac{1}{a_{11} \Delta t c}I_n + \frac{1}{4\pi}\sigma_{s} \phi_1  \dots \\ 
+  \sigma_a  D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{11} \Delta t }{C_v} \sigma_a \phi_1  \dots \\
+ S_I + \sigma_a B_* 
+ \sigma_a D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n - T_* + \frac{a_{11} \Delta t }{C_v} \left[  S_T - 4\pi \sigma_a   B_*\right]  \right) \pec
\end{multline}
and define
\benum
\sigma_{\tau,1} = \sigma_t + \frac{1}{a_{11} \Delta t c} \pec
\label{eq:tau_1_analytic}
\eenum
giving
\begin{multline}
\mu_d \frac{\partial I_1}{\partial x} + \sigma_{\tau,1} I_1 = \frac{1}{a_{11} \Delta t c}I_n + \frac{1}{4\pi}\sigma_{s} \phi_1  \dots \\ 
+  \sigma_a  D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{11} \Delta t }{C_v} \sigma_a \phi_1  \dots \\
+ S_I + \sigma_a B_* 
+ \sigma_a D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n - T_* + \frac{a_{11} \Delta t }{C_v} \left[  S_T - 4\pi \sigma_a   B_*\right]  \right) \pep
\end{multline}
Focusing on the second $\phi_1$ term on the right hand side,
\benum
\sigma_a  D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{11} \Delta t }{C_v} \sigma_a \phi_1 \pec
\eenum
multiplying by $\frac{4\pi}{4\pi}$ we have:
\benum
\frac{1}{4\pi} \left( 4\pi  a_{11} \Delta t \sigma_a  D_*  \right) \left(C_v + 4\pi a_{11} \Delta t \sigma_a D_*  \right)^{-1}\sigma_a \phi_1 \pec
\eenum
and defining a constant, $\nu_1$,
\benum
\nu_1 = \left( 4\pi  a_{11} \Delta t \sigma_a  D_*  \right) \left(C_v + 4\pi a_{11} \Delta t \sigma_a D_*  \right)^{-1} \pec
\eenum
we arrive at an equation for intensity $I_1$ that appears like a neutron transport with isotropic scattering, fission, and a fixed source:
\benum
\mu_d \frac{\partial I_1}{\partial x} + \sigma_{\tau,1} I_1 = \frac{1}{4\pi}\sigma_{s} \phi_1 + \frac{1}{4\pi}\nu_1 \sigma_a \phi_1 + \xi_1 \pec
\label{eq:i_analytic_pseudo}
\eenum
where
\begin{multline}
\xi_1 = \frac{1}{a_{11} \Delta t c}I_n + S_I + \sigma_a B_* + \dots \\
\sigma_a D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n - T_* + \frac{a_{11} \Delta t }{C_v} \left[  S_T - 4\pi \sigma_a   B_*\right]  \right) \pep
\end{multline}
If we define pseudo total interaction and scattering cross sections, $\widetilde{\Sigma_t}$ and $\widetilde{\Sigma_s}$, to be
\beanum
\widetilde{\Sigma_t} &=& \sigma_{\tau,1} \\
\widetilde{\Sigma_s} &=& \sigma_s + \nu_1 \sigma_a\pec
\eeanum
and a pseudo absorption interaction cross section as,
\benum
\widetilde{\Sigma_a}  = \widetilde{\Sigma_t} - \widetilde{\Sigma_s} \pec
\eenum
then it appears that all of the methodology, including DSA, developed for discrete ordinates neutron transport might be applicable for solving the discrete ordinates thermal radiative transfer equations using SDIRK time integration.
The next step in examining the possibility of applying neutron transport methods to solve the TRT equations is to attempt to form a pseudo neutron transport equation for stage $i$ of any SDIRK time integration scheme. 

\subsubsection{SDIRK Stage $i$}

The intensity at stage $i$, $t=t_n + c_i \Delta t$, is given by:
\benum
I_i = I_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{I,j}} + a_{ii} \Delta t c \left[ \frac{1}{4\pi}\sigma_{s} \phi_i + \sigma_a \left[B_* + D_* (T_i - T_*) \right]+ S_I - \mu_d \frac{\partial I_i}{\partial x} - \sigma_t I_i \right] 
\pep
\label{eq:i_i_start}
\eenum
Likewise for $T_i$, we have
\benum
T_i = T_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} + \frac{a_{ii} \Delta t }{C_v} \left[ \sigma_a \left( \phi_i - 4\pi \left[ B_* + D_*(T_i - T_*) \right] \right) + S_T  \right] \pep
\label{eq:analytic_t_i_start}
\eenum
Proceeding as for SDIRK stage 1, we work to move all $T_i$ terms of \eqt{eq:analytic_t_i_start} to the left hand side,
\benum
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)T_i = T_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}}  + \frac{a_{ii} \Delta t }{C_v} \left[ \sigma_a \left( \phi_i - 4\pi   B_* + 4\pi D_*  T_* \right) + S_T  \right] \pep
\eenum
Next, we divide by the coefficient in front of $T_i$ on the left hand side:
\begin{multline}
T_i = \left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} \right) + \dots \\
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{ii} \Delta t }{C_v} \left[ \sigma_a \left( \phi_i- 4\pi   B_* \right) + S_T \right] + \dots \\
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{ 4\pi a_{ii} \Delta t }{C_v} \sigma_a D_*  T_* \pec
\end{multline}
and then add ``nothing'' ,
\benum
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_* - T_* \right) \pec
\eenum
to the right hand side,
\begin{multline}
T_i = \left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} \right) + \dots \\
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{ii} \Delta t }{C_v} \left[ \sigma_a \left( \phi_i - 4\pi   B_* \right) + S_T \right] + \dots \\
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left(1 + \frac{ 4\pi a_{ii} \Delta t }{C_v} \sigma_a D_* \right) T_* \dots \\
-\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} T_*\pep
\end{multline}
Noting that 
\benum
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left(1 + \frac{ 4\pi a_{ii} \Delta t }{C_v} \sigma_a D_* \right)  = 1 \pec
\eenum
and condensing, we have:
\begin{multline}
T_i = T_* + \left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \\
\left( T_n - T_* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} +  \frac{a_{ii} \Delta t }{C_v} \left[ \sigma_a \left( \phi_i - 4\pi   B_* \right) + S_T \right]  \right) \pep
\label{eq:analytic_t_i}
\end{multline}
Inserting \eqt{eq:analytic_t_i} into \eqt{eq:i_i_start}, dividing by $a_{ii} c \Delta t$, and moving the gradient and interaction terms to the left hand side:
\begin{multline}
\mu_d \frac{\partial I_i}{\partial x} + \left(\frac{1}{a_{ii} \Delta t c} + \sigma_t \right) I_i = \frac{1}{a_{ii} \Delta t c} I_n + \frac{1}{a_{ii} c} \sum_{j=1}^{i-1}{a_{ij} k_{I,j}} + \dots\\
\frac{1}{4\pi}\sigma_{s} \phi_i + \sigma_a B_* + S_I \dots \\
 + \sigma_a D_*\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} 
\left( T_n - T_* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} \right) \dots \\
+   \sigma_a D_*\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1}  \frac{a_{ii} \Delta t }{C_v} \left[ \sigma_a \left( \phi_i - 4\pi   B_* \right) + S_T \right]  \pep
\end{multline}
Isolating the $\phi_i$ term that has a coefficient based on the Planck linearization:
\begin{multline}
\mu_d \frac{\partial I_i}{\partial x} + \left(\frac{1}{a_{ii} \Delta t c} + \sigma_t \right) I_i = \frac{1}{a_{ii} \Delta t c} I_n + \frac{1}{a_{ii} c} \sum_{j=1}^{i-1}{a_{ij} k_{I,j}} + \dots\\
\frac{1}{4\pi}\sigma_{s} \phi_i + \sigma_a B_* + S_I \dots \\
 + \sigma_a D_*\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} 
\left( T_n - T_* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} +   \frac{a_{ii} \Delta t }{C_v}  \left( S_T -  4\pi  \sigma_a B_*   \right) \right) \dots \\
+   \sigma_a D_*\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1}  \frac{a_{ii} \Delta t }{C_v} \sigma_a  \phi_i  \pec
\end{multline}
defining 
\benum
\nu_i = 4\pi \sigma_a D_* \left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1}  \frac{a_{ii} \Delta t }{C_v} = \frac{ 4\pi a_{ii} \sigma_a D_*}{C_v + 4\pi a_{ii} \Delta t  \sigma_a D_*} \pec
\eenum
\benum
\sigma_{\tau,i} = \frac{1}{a_{ii} \Delta t c} + \sigma_t \pec
\label{eq:tau_i_analytic}
\eenum
and
\begin{multline}
\xi_i = \sigma_a B_* + S_I +  \frac{1}{a_{ii} \Delta t c} I_n + \frac{1}{a_{ii} c} \sum_{j=1}^{i-1}{a_{ij} k_{I,j}}  + \dots  \\ 
\sigma_a D_*\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} 
\left( T_n - T_* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} +   \frac{a_{ii} \Delta t }{C_v}  \left( S_T -  4\pi  \sigma_a B_*   \right) \right) \pec
\end{multline}
we arrive at another equation that appears to be similar to the neutron transport equation with isotropic scattering, a fission source, and a fixed source:
\benum
\mu_d \frac{\partial I_i}{\partial x} + \sigma_{\tau,i} = \frac{1}{4\pi} \sigma_s \phi_i + \frac{1}{4\pi}\nu_i \sigma_a \phi_i + \xi_i \pep
\label{eq:analytic_pseudo_i}
\eenum
In the spatially analytic case, the grey TRT equations, with Planck linearization and arbitrary stage count SDIRK time integration can be put into a pseudo neutron transport form.
This suggests that we may techniques such as spatial discretization and acceleration methods, can be used to solve the grey TRT equations.
Since we will go through the entire linearization procedure with the spatially discretized grey TRT equations in the next section, it may seem unnecessary to have performed the preceding  for the spatially analytic case.

If we could solve the spatially discretized equations efficiently through source iteration alone, it would be redundant to linearize the the spatially analytic and spatially discretized TRT equations.
However, iterative acceleration is essential for efficient solution of the TRT equations due to the Planckian absorption/re-emission terms in the linearized radiation intensity equation creating a situation analogous to a scattering dominated medium in neutron transport.
As we will see, the problem with accelerating the spatially discretized TRT equations is that we will need a pseudo diffusion coefficient, $\widetilde{D}$, both at quadrature integration points and cell edges for MIP DSA acceleration.
While we will still define,
\benum
\widetilde{D} = \frac{1}{3\widetilde{\Sigma}_t} \pec
\eenum
we will only have guaranteed integral information about $\widetilde{\Sigma}_t$ coming from a pseudo reaction matrix, $\mathbf{R}_{\widetilde{\Sigma}_t}$.

\subsection{Spatially Discretized Linearization}
Now we will attempt to derive a pseudo fission form of the spatially discretized grey TRT equations.
First, we must define a spatially discretized $k_I$ and $k_T$.
To do this, we apply the standard Galerkin procedure outlined in \chapref{sec:chapter2_constant_xs} and \chapref{sec:chapter3_variable_xs} to the spatially analytic forms of $k_{I}$ and $k_{T}$ given in \eqt{eq:k_I_stage} and \eqt{eq:k_T_stage}, respectively.
For $\vec{k}_{I}$, we have:
\benum
\vec{k}_{I}= c \M^{-1} 
\left[
\frac{1}{4\pi}\R{\sigma_s}\vec{\phi} + \R{\sigma_a}\vec{B} - \R{\sigma_t} \vec{I} - \mu_d\mathbf{G}\vec{I} + \mu_d I_{in} \vec{f}+ \vec{S}_I
\right] \pec
\eenum
where we have approximated the true angular intensity, angle integrated intensities, and temperatures as $P$ degree polynomials:
\beanum
I(s) &\approx& \widetilde{I}(s) \\
\widetilde{I}(s) &=& \sum_{i=1}^{N_P}{ I_i \B{i}(s) } \\
\phi(s) &\approx& \widetilde{\phi(s) }\\
\widetilde{\phi}(s) &=& \sum_{i=1}^{N_P}{ \phi_i \B{i}(s) } \\
T(s) &\approx& \widetilde{T}(s) \\
\widetilde{I}(s) &=& \sum_{i=1}^{N_P}{T_i \B{i}(s) } \pec
\eeanum
with
\beanum
\vec{I} &=& \left[  I_1 \dots I_{N_P} \right]^T \\
\vec{\phi} &=&\left[  \phi_1 \dots \phi_{N_P} \right]^T \\
\vec{T} &=& \left[  T_1 \dots T_{N_P} \right]^T \\
\vec{B} &=& \frac{1}{4\pi} \left[  B(T_1) \dots B(T_{N_P}) \right]^T \pec
\eeanum
and
\benum
\vec{S}_{I,j} = \frac{\Delta x}{2}\int_{-1}^1{\B{j}(s) S_I(s) ~ds} \pep
\eenum
Additionally, $\R{\sigma_t}$ , $\R{\sigma_a}$, and $\R{\sigma_s}$, are defined analogously to the $\R{\Sigma}$ defined for neutron transport, as are $\mathbf{G}$, $\mathbf{M}$, and $\vec{f}$.
Defining $\vec{k}_T$:
\benum
\vec{k}_T =  \R{C_v}^{-1}
\left[ \R{\sigma_a} \left(\vec{\phi} - 4\pi\vec{B} \right) + \vec{S}_T \right] \pec
\label{eq:k_t_discretized}
\eenum
with
\benum
\vec{S}_{T,j} = \frac{\Delta x}{2}\int_{-1}^1{\B{j}(s) S_T(s) ~ds} \pec
\eenum
and
\benum
\mathbf{R}_{C_v,ij} = \frac{\Delta x}{2}\int_{-1}^1{C_v(s) \B{i}(s)\B{j}(s)~ds} \pep
\eenum

\subsubsection{SDIRK Stage 1}
We now write down the spatially discretized, grey TRT equations with a Planckian that has been linearized in temperature, for the first SDIRK stage.
\begin{multline}
\vec{I}_1 = \vec{I}_n + c\Delta t a_{11}\M^{-1}\left[   
\frac{1}{4\pi}\R{\sigma_s,*}\vec{\phi}_1 + \R{\sigma_a,*}\left(\vec{B}_* + \D \left(\vec{T}_1 -\vec{T}_*  \right)   \right) \dots \right. \\
\left. - \R{\sigma_t,*} \vec{I}_1 - \mu_d \mathbf{G}\vec{I}_1 + \mu_d I_{in,1}\vec{f} 
+ \vec{S}_I
\right]
\label{eq:first_I}
\end{multline}
\benum
\vec{T}_1  = \vec{T}_n + \Delta t a_{11} \R{C_v,*}^{-1}\left[
\R{\sigma_a,*} \left(\vec{\phi}_1 - 4\pi\vec{B}_* - 4\pi\D\left( \vec{T}_1 - \vec{T}_* \right)\right) + \vec{S}_T
\right]
\label{eq:first_T}
\eenum
In \eqt{eq:first_I}, \eqt{eq:first_T}, and all of the equations that follow, we will evaluate all material properties ($\sigma$, $C_v$) at $\widetilde{T}_*$.
We will no longer denote this with $_*$, to improve equation readability. 
We now use \eqt{eq:first_T} to eliminate the unknown temperature, $\vec{T}_1$ from \eqt{eq:first_I}. 
We start by moving the $\vec{T}_1$ terms to the left hand side of \eqt{eq:first_T}:
\benum
\vec{T}_1 +  4\pi\Delta t a_{11} \R{C_v}^{-1}\R{\sigma_a}\D \vec{T}_1   = \vec{T}_n + \Delta t a_{11} \R{C_v}^{-1}
\left[
\R{\sigma_a} \left(\vec{\phi}_1 -  4\pi\vec{B}_*+ 4\pi\D\vec{T}_* \right) + \vec{S}_T
\right] \pep
\eenum
Multiplying by,
\benum
 \left[\mathbf{I}+ 4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right]^{-1}
\eenum
to get rid of the matrices in front of $\vec{T}_1$ and adding a ``zero'', 
\benum
 \left[\mathbf{I}+ 4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right]^{-1}\left[\vec{T}_* - \vec{T}_*  \right] \pec
\eenum
to the right hand side yields:
\begin{multline}
\vec{T}_1 = \left[\mathbf{I} + 4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right]^{-1}
\left\{
\vec{T}_n + \right. \\
 \left. \Delta t a_{11}  \R{C_v}^{-1}\left[ \R{\sigma_a} \left(\vec{\phi}_1 -4\pi \vec{B}_*+ 4\pi \D \vec{T}_* \right) +  \vec{S}_T \right]  
\right\} \dots \\
 + \left[\mathbf{I}+ 4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right]^{-1}\left[\vec{T}_* - \vec{T}_*  \right] \pec
\end{multline}
where $\mathbf{I}$ is the $N_P \times N_P$ identity matrix.
Re-arranging gives
\begin{multline}
\vec{T}_1 = \left[\I+ 4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right]^{-1}
\left[
\vec{T}_n + \Delta t a_{11}  \R{C_v}^{-1}\left[ \R{\sigma_a} \left(\vec{\phi}_1 - 4\pi\vec{B}_*  \right)+ \vec{S}_T \right]\right] \dots \\ 
+ 
\left[\I +  4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1}
\left[\I +  4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right] \vec{T}_* \dots \\
- \left[\I +  4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right]^{-1}\vec{T}_* \pec
\end{multline}
noting the identity:
\benum
\left[\I +  4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right]^{-1}\left[\I +  4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right] = \I \pec
\eenum
%
yields the stage 1 temperature update equation,
\benum
\vec{T}_1 = \vec{T}_* + \left[\I + 4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D \right]^{-1}\left[\vec{T}_n - \vec{T}_* +  \Delta t a_{11}  \R{C_v}^{-1}\left[ \R{\sigma_a} \left(\vec{\phi}_1 - 4\pi\vec{B}_*\right) + \vec{S}_{T}\right]\right] \pep
\label{eq:iso_T1}
\eenum
%
%
Inserting \eqt{eq:iso_T1} into \eqt{eq:first_I}:
\begin{multline}
\vec{I}_1 = \vec{I}_n + c\Delta t a_{11}\M^{-1}\left[   
\frac{1}{4\pi}\R{\sigma_s}\vec{\phi}_1 + \R{\sigma_a}\vec{B}_* - \R{\sigma_t} \vec{I}_1 - \mu_d \mathbf{G}\vec{I}_1 + \mu_d I_{in,1}\vec{f} + \vec{S}_I \right] \dots  \\
+ c \Delta t a_{11}\M^{-1} \R{\sigma_a}\D
\left[\I + 4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right]^{-1}
\left\{ \vec{T}_n - \vec{T}_* \right. \\
\left. +  \Delta t a_{11} \R{C_v}^{-1}\left[ \R{\sigma_a} \left(\vec{\phi}_1 - 4\pi\vec{B}_*\right) + \vec{S}_T \right]\right\} \pec
\end{multline}
%
%
%
and then multiplying by $\frac{1}{c\Delta t a_{11}}\M$, we have
\begin{multline}
\frac{1}{c\Delta t a_{11}}\M\vec{I}_1 = \frac{1}{c\Delta t a_{11}}\M\vec{I}_n + 
\frac{1}{4\pi}\R{\sigma_s}\vec{\phi}_1 + \R{\sigma_a}\vec{B}_* - \R{\sigma_t} \vec{I}_1 - \mu_d \mathbf{G}\vec{I}_1 + \mu_d I_{in,1}\vec{f}  + \vec{S}_I\dots  \\
+ \R{\sigma_a} \D
\left[\I+ 4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right]^{-1}
\left\{\vec{T}_n - \vec{T}_* +  \Delta t a_{11} \R{C_v}^{-1}\left[ \R{\sigma_a} \left(\vec{\phi}_1 - 4\pi\vec{B}_*\right) + \vec{S}_T\right]\right\}  \pep
\end{multline}
%
%
%
Moving terms that are normally given on the left hand side
\begin{multline}
\mu_d \mathbf{G}\vec{I}_1 + \left(\frac{1}{c\Delta t a_{11}} \M + \R{\sigma_t} \right)\vec{I}_1 = \frac{1}{c\Delta t a_{11}}\M\vec{I}_n +   
\frac{1}{4\pi}\R{\sigma_s}\vec{\phi}_1 + \R{\sigma_a}\vec{B}_* + \mu_d I_{in,1} \vec{f} + \vec{S}_I \dots  \\
+ \R{\sigma_a} \D \left[\I+ 4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right]^{-1}
\left\{\vec{T}_n - \vec{T}_* +  \Delta t a_{11}  \R{C_v}^{-1}\left[ \R{\sigma_a} \left(\vec{\phi}_1 - 4\pi\vec{B}_*\right) + \vec{S}_T\right]\right\} \pec
\end{multline}
%
%above here
%
and further manipulating to isolate $\vec{\phi}_1$ terms on the right hand side, we have:
%
%
\begin{multline}
\mu_d \mathbf{ G}\vec{I}_1 + \left(\frac{1}{c\Delta t a_{11}} \M + \R{\sigma_t} \right)\vec{I}_1 = \dots \\
\frac{1}{4\pi}\R{\sigma_s}\vec{\phi}_1 + \Delta t a_{11} \R{\sigma_a} \D
\left[\I + 4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a} \D   \right]^{-1}
\R{C_v}^{-1}\R{\sigma_a} \vec{\phi}_1 \dots \\
+ \frac{1}{c\Delta t a_{11}}\M \vec{I}_n +\R{\sigma_a}\vec{B}_* + \mu_d I_{in,1} \vec{f} + \vec{S}_I  \dots \\
+ \R{\sigma_a} \D
\left[\I +4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a} \D   \right]^{-1}
\left\{ \vec{T}_n - \vec{T}_* + \Delta t a_{11}  \R{C_v}^{-1}\left[ \vec{S}_T - 4\pi\R{\sigma_a} \vec{B}_*\right] \right\} \pep
\label{eq:almost_1}
\end{multline}
Equation (\ref{eq:almost_1}) can be made to resemble the canonical mono-energetic neutron fission equation by defining the following terms,
\begin{subequations}
%
\label{eq:step1_defs}
%
\benum
\overline{\overline{\mathbf \nu}}_1 = 4\pi\Delta t a_{11} \R{\sigma_a}
\D \left[\I + 4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right]^{-1}\R{C_v}^{-1}
\eenum 
 %
%
 \begin{multline}
\overline{\overline{\mathbf \xi}}_{d,1} = \frac{1}{c\Delta t a_{11}}\M\vec{I}_n + \R{\sigma_a}\vec{B}_*  + \vec{S}_I \dots \\ 
+ \R{\sigma_a} \D
\left[\I + 4\pi\Delta t a_{11}  \R{C_v}^{-1}\R{\sigma_a}\D   \right]^{-1}
\left[\vec{T}_n - \vec{T}_* + \Delta t a_{11}  \R{C_v}^{-1}\left[\vec{S}_T - 4\pi\R{\sigma_a}\vec{B}_*\right]\right] 
\end{multline}
%%
%%
\benum
\overline{\overline{\mathbf R}}_{\sigma_{\tau},1} = \frac{1}{c\Delta t a_{11}} \M + \R{\sigma_t} \pep
\eenum
%
\end{subequations}
Inserting \eqts{eq:step1_defs} into \eqt{eq:almost_1} gives our final form:
\benum
 \mu_d\mathbf{G}\vec{I}_1 + \overline{\overline{\mathbf R}}_{\sigma_{\tau},1}\vec{I}_1 = \frac{1}{4\pi}\R{\sigma_s}\vec{\phi}_1 + \frac{1}{4\pi}\overline{\overline{\mathbf \nu}}_1\R{\sigma_a} \vec{\phi}_1 +  \mu_d I_{in,1}\vec{f} + \overline{\overline{\mathbf \xi}}_{d,1} \pep
\label{eq:1_done}
\eenum
%
\subsubsection{SDIRK Stage $i$}
Moving on to the $i$-th RK step, we first write the equation for $\vec{I}_i$ and $\vec{T}_{i}$:
\begin{multline}
\vec{I}_i = \vec{I}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{I,j}   } + \\
\Delta t a_{ii} c \M^{-1}\left[ \frac{1}{4\pi}\R{\sigma_s}\vec{\phi}_i +
\R{\sigma_a}\left(\vec{B}_* + \D \left(\vec{T}_i -\vec{T}_*  \right)   \right)- \R{\sigma_t} \vec{I}_i - \mu_d \mathbf{G}\vec{I}_i + \mu_d I_{in,i} \vec{f}+ \vec{S}_I
\right]
\label{eq:first_kIi}
\end{multline}
\benum
\vec{T}_i = \vec{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   } + \Delta t a_{ii}\R{C_v}^{-1}\left[
\R{\sigma_a}\left(\vec{\phi}_i - 4\pi\vec{B}_* - 4\pi\D\left( \vec{T}_i - \vec{T}_* \right)\right) + \vec{S}_T 
\right] \pep
\label{eq:first_kTi}
\eenum
%
%
We now solve \eqt{eq:first_kTi} for $\vec{T}_{i}$, by first moving all $\vec{T}_i$ terms to the left hand side: 
%
%
\begin{multline}
\vec{T}_i +4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D\vec{T}_i = \\
\vec{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   } + \Delta t a_{ii}
\R{C_v}^{-1}\left[
\R{\sigma_a} \left(\vec{\phi}_i - 4\pi\vec{B}_* + 4\pi\D\vec{T}_* \right) + \vec{S}_T
 \right] \pec
\end{multline}
%
%
and consolidate the $\vec{T}_i$ coefficient matrices,
\begin{multline}
\left[\I + 4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]\vec{T}_i = \\
\vec{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   } + \Delta t a_{ii}\R{C_v}^{-1}\left[\R{\sigma_a} \left(\vec{\phi}_i - 4\pi\vec{B}_* + 4\pi\D\vec{T}_* \right) + \vec{S}_T \right] \pep
\end{multline}
%
Multiplying the inverse of the coefficient matrix,
%
\begin{multline}
\vec{T}_i = \left[\I+ 4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1}\left[\vec{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   }\right] \dots \\
+ \Delta t a_{ii}\left[\I+  4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1}\R{C_v}^{-1}\left[
\R{\sigma_a} \left(\vec{\phi}_i - 4\pi\vec{B}_* + 4\pi\D\vec{T}_* \right) + \vec{S}_T 
\right] \pec
\end{multline}
%
Isolating the $\vec{T}_*$ term on the right hand side,
%
\begin{multline}
\vec{T}_i = \left[\I +4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1}\left[\vec{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   }\right] \dots \\
+ \Delta t a_{ii}\left[\I +4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1}
\R{C_v}^{-1}\left[ \R{\sigma_a}\left(\vec{\phi}_i - 4\pi\vec{B}_*\right)  + \vec{S}_T \right]\dots \\
+4\pi\Delta t a_{ii}\left[\I + 4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1}
\R{C_v}^{-1}\R{\sigma_a}\D\vec{T}_* \pec
\end{multline}
%
%
adding nothing,
\begin{multline}
\vec{T}_i = \left[\I + 4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1}\left[\vec{T}_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   }\right] \dots \\
+ \Delta t a_{ii}\left[\I+ 4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1}
\R{C_v}^{-1}\left[\R{\sigma_a} \left(\vec{\phi}_i -  4\pi\vec{B}_*\right) + \vec{S}_T \right]\dots \\
+\left[\I+ 4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1}
\left[ 4\pi\Delta t a_{ii} \R{C_v}^{-1}\R{\sigma_a}  \D\vec{T}_* \right]\dots \\
+ \left[\I + 4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1} \left( \vec{T}_* - \vec{T}_*\right) \pec
\end{multline}
%
%
and noting that
\benum
\left[ 4\pi\Delta t a_{ii} \R{C_v}^{-1}\R{\sigma_a}  \D\vec{T}^* \right]^{-1}\left[ 4\pi\Delta t a_{ii} \R{C_v}^{-1}\R{\sigma_a}  \D\vec{T}^* \right] = \I \pec
\eenum
%
%
we reach the stage $i$ temperature update equation,
\begin{multline}
\vec{T}_i = \vec{T}_*   + \left[\I+ 4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1}\left[\vec{T}_n -\vec{T}_* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   }\right] \dots \\
+ \Delta t a_{ii}\left[\I + 4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1}\R{C_v}^{-1}
\left[ \R{\sigma_a}\left(\vec{\phi}_i - 4\pi\vec{B}_*  \right) + \vec{S}_T \right] \pep
\label{eq:Ti_iso}
\end{multline}
%
Multiplying \eqt{eq:first_kIi} by $\frac{1}{c\Delta t a_{ii}}\M$:
\begin{multline}
\frac{1}{c\Delta t a_{ii}}\M\vec{I}_i = \frac{1}{c\Delta t a_{ii}}\M\vec{I}_n + \frac{1}{c a_{ii}} \M \sum_{j=1}^{i-1}{a_{ij} k_{I,j}   } \dots \\
+ 
\frac{1}{4\pi}\R{\sigma_s}\vec{\phi}_i + 
\R{\sigma_a}\left(\vec{B}_* + \D\left(\vec{T}_i -\vec{T}_*  \right)   \right)- \R{\sigma_t} \vec{I}_i - \mu_d\mathbf{G}\vec{I}_i + \mu_d I_{in,i} \vec{f}+ \vec{S}_I \pec
\label{eq:kIi_second}
\end{multline}
%
%
moving the gradient terms and $\frac{1}{a_{ii} c \Delta } \M \vec{I}_i$ to the left hand side and inserting the result of \eqt{eq:Ti_iso} into \eqt{eq:kIi_second}, we have:
%
%
\begin{multline}
\mu_d \mathbf{G} \vec{I}_i + \left( \frac{1}{c\Delta t a_{ii}}\M + \R{\sigma_t} \right) \vec{I}_i = 
\frac{1}{c\Delta t a_{ii}}\M\vec{I}_n + \frac{1}{c a_{ii}} \M \sum_{j=1}^{i-1}{a_{ij} k_{I,j}   } 
+ \frac{1}{4\pi}\R{\sigma_s}\vec{\phi}_i 
+ \R{\sigma_a}\vec{B}_* \dots \\ 
+ \R{\sigma_a} \D \left \{
\left[\I + 4\pi \Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1}
\left[\vec{T}_n -\vec{T}_* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}   }\right]   \dots \right.  \\
\left.
+ \Delta t a_{ii}\left[\I+ 4\pi \Delta t a_{ii}\R{C_v}^{-1} \R{\sigma_a}\D  \right]^{-1} 
\R{C_v}^{-1}\left[\R{\sigma_a} \left(\vec{\phi}_i - 4\pi \vec{B}_*  \right) + \vec{S}_T \right]  \right \} + \mu_d I_{in,i} \vec{f} + \vec{S}_I \pep
\label{eq:intensity_stage_i_intermediate}
\end{multline}
%
%
Re-arranging \eqt{eq:intensity_stage_i_intermediate} to isolate $\vec{\phi}_i$ terms on the right hand side, we have:
%
%
\begin{multline}
\mu_d \mathbf{G} \vec{I}_i + \left( \frac{1}{c\Delta t a_{ii}}\M + \R{\sigma_t} \right) \vec{I}_i =  \frac{1}{4\pi}\R{\sigma_s}\vec{\phi}_i \dots \\
%
%
+  \Delta t a_{ii} \R{\sigma_a} \D
\left[\I + 4\pi \Delta t a_{ii}\R{C_v}^{-1} \R{\sigma_a}\D  \right]^{-1}\R{C_v}^{-1}\R{\sigma_a}\vec{\phi}_i\dots \\
%
%
+ \mu_d \vec{f}I_{in,i} + \vec{S}_I +  \frac{1}{c\Delta t a_{ii}}\M\vec{I}_n + \frac{1}{c a_{ii}} \M \sum_{j=1}^{i-1}{a_{ij} k_{I,j}   } + \R{\sigma_a}\vec{B}_* \dots \\
%
%
+ \R{\sigma_a} \D
\left[\I+ 4\pi \Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a} \D\right]^{-1}
\left[ \vec{T}_n - \vec{T}_* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}  }\right] \dots \\
  +\Delta t a_{ii}  \R{C_v}^{-1} \left[\I+ 4\pi \Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a} \D\right]^{-1} \left[\vec{S}_T - 4\pi\R{\sigma_a} \vec{B}_* \right] \pep
\end{multline}
Making the following definitions:
\begin{subequations}
\label{eq:step_i_defs}
\begin{multline}
\overline{\overline{\mathbf \xi}}_{d,i}  = \frac{1}{c\Delta t a_{ii}}\M\vec{I}_n + \frac{1}{c a_{ii}} \M \sum_{j=1}^{i-1}{a_{ij} k_{I,j}   } + \R{\sigma_a}\vec{B}_*  + \vec{S}_I \dots \\
+ \R{\sigma_a} \D
\left[\mathbf{I} + 4\pi \Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a} \D \right]^{-1}
\left \{
\vec{T}_n - \vec{T}_* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j} }  \right.  \\
\left. + \Delta t a_{ii} \R{C_v}^{-1}\left[\vec{S}_T - 4\pi\R{\sigma_a} \vec{B}_* \right] \right \} 
\label{eq:almost_stage_i}
\end{multline}
 %
 %
\beanum
\overline{\overline{\mathbf \nu}}_i &=& 4\pi \Delta t a_{ii} \R{\sigma_a} \D \left[\mathbf{I} + 4\pi\Delta t a_{ii}\R{C_v}^{-1}\R{\sigma_a}\D  \right]^{-1}\R{C_v}^{-1}
\\
\overline{\overline{\mathbf R}}_{\sigma_{\tau},i} &=& \R{\sigma_t} + \frac{1}{c\Delta t a_{ii}}\M \pec
\eeanum
\end{subequations}
and inserting into \eqt{eq:almost_stage_i} gives our final equation for the radiation intensity:
\benum
\mu_d\mathbf{G} \vec{I}_i + \overline{\overline{\mathbf R}}_{\sigma_{\tau},i}\vec{I}_i = \frac{1}{4\pi}\R{\sigma_s}\vec{\phi}_i + \frac{1}{4\pi}\overline{\overline{\mathbf \nu}}_i \R{\sigma_a}\vec{\phi}_i + \overline{\overline{\mathbf \xi}}_{d,i} + \mu_d\vec{f}I_{in,i} \pep
\label{eq:stage_i_sdirk_intensity}
\eenum
Given the form of \eqt{eq:stage_i_sdirk_intensity}, it appears that we can apply MIP DSA to accelerate the iterative solution of \eqt{eq:stage_i_sdirk_intensity}, but we still wish to verify that definition of $\widetilde{\Sigma}_t$ and $\widetilde{\Sigma}_a$ is consistent  between both the spatially discretized and spatially analytic cases.

\subsection{Consistency of Pseudo Cross Sections}
In \chapref{sec:chapter4_acceleration}, we used MIP DSA to accelerate a spatially analytic problem of the form
\benum
\mu_d \frac{\p \psi}{\p x} + \Sigma_t \psi = \frac{1}{4\pi} \Sigma_s \phi + Q_d \pec
\label{eq:analytc_xs_mip}
\eenum
with spatially discretized analog
\benum
\mu_d \frac{\p \psi}{\p x} \R{\Sigma_t} \psi = \frac{1}{4\pi} \R{\Sigma_s} \phi + \vec{Q}_d \pep
\label{eq:discrete_xs_mip}
\eenum
In the neutron transport problem, $\Sigma_t$, $\Sigma_s$, and $\Sigma_a$ are physically meaningful quantities, the total macroscopic interaction cross section, macroscopic scattering cross section, and absorption macroscopic cross section are inherent physical properties of a material, and by definition
\benum
\Sigma_a + \Sigma_s = \Sigma_t \pep
\eenum
Likewise for the spatially discretized case, it is true that
\benum
\R{\Sigma_a} = \R{\Sigma_t} - \R{\Sigma_s} \pec
\label{eq:r_sig_a_calculation}
\eenum
since we have defined
\begin{subequations}
\label{eq:three_r_sig}
\beanum
\R{\Sigma_a,ij} &=& \frac{\Delta x}{2} \int_{-1}^1{ \Sigma_a(s) \B{i}(s) \B{j}(s)~ds} \\
\R{\Sigma_s,ij} &=& \frac{\Delta x}{2} \int_{-1}^1{ \Sigma_s(s) \B{i}(s) \B{j}(s)~ds} \\
\R{\Sigma_t,ij} &=& \frac{\Delta x}{2} \int_{-1}^1{ \Sigma_t(s) \B{i}(s) \B{j}(s)~ds} \pep
\eeanum
\end{subequations}
To verify this, apply the definition \eqt{eq:r_sig_a_calculation} using the definition of \eqts{eq:three_r_sig},
\benum
\R{\Sigma_a,ij} \overset{?}{=} \frac{\Delta x}{2} \int_{-1}^1{ \Sigma_t(s) \B{i}(s) \B{j}(s)~ds} - \frac{\Delta x}{2} \int_{-1}^1{ \Sigma_s(s) \B{i}(s) \B{j}(s)~ds} \pec
\eenum
and obviously,
\benum
\R{\Sigma_a,ij} = \frac{\Delta x}{2} \int_{-1}^1{ \left( \Sigma_t(s) - \Sigma_s(s) \right) \B{i}(s) \B{j}(s)~ds} = \frac{\Delta x}{2} \int_{-1}^1{ \Sigma_a(s) \B{i}(s) \B{j}(s)~ds} \pep
\eenum

However, though the forms of \eqt{eq:analytic_pseudo_i} and \eqt{eq:stage_i_sdirk_intensity} appear analogous to neutron transport, are the linearized, pseudo interaction cross sections (\eqt{eq:analytic_pseudo_i}) and their spatially discretized analogs, (\eqt{eq:stage_i_sdirk_intensity}), equivalent?
That is, if we started with the spatially analytic linearization, \eqt{eq:analytic_pseudo_i}, re-cast as,
\benum
\mu_d \frac{\p I}{\p x} + \widetilde{\Sigma}_t I = \widetilde{\Sigma}_s \phi + \xi_{d,i}
\eenum
with
\beanum
\widetilde{\Sigma_t} &=& \sigma_{\tau,i} \\
\widetilde{\Sigma_s} &=& \sigma_s + \nu_i \sigma_a \pep
\eeanum
Then applied the Galerkin procedure, yielding,
\benum
\mu_d \mathbf{G} \vec{I} + \R{\widetilde{\Sigma_t}}\vec{I} = \R{\widetilde{\Sigma_s}}\vec{\phi} + \vec{\widetilde{\xi}}_{d,i}
\eenum
with
\begin{subequations}
\label{eq:funky_defs}
\beanum
\R{\widetilde{\Sigma_t},jk} &=& \frac{\Delta x}{2}\int_{-1}^1{ \widetilde{\Sigma}_t(s)\B{j}(s) \B{k}(s)~ds }\\
\R{\widetilde{\Sigma_s},jk}&=& \frac{\Delta x}{2}\int_{-1}^1{ \widetilde{\Sigma}_s(s)\B{j}(s) \B{k}(s)~ds } \\
\vec{\widetilde{\xi}}_{d,j} &=& \frac{\Delta x}{2}\int_{-1}^1{ \B{j}(s) \xi_{d,i}~ds } \pep
\eeanum
\end{subequations}
In \eqts{eq:funky_defs}, use $i$ subscript to denote SDIRK stage $i$, $j$ to denote matrix row, and $k$ to denote matrix column.  We will continue this notation for the remainder of this section.
Would the definitions of \eqts{eq:funky_defs} be equivalent to
\begin{subequations}
\beanum
\overline{\overline{\mathbf R}}_{\sigma_{\tau,i}} \pec \\
\R{\sigma_s} + \overline{\overline{\nu}}_i \R{\sigma_a} \pec \text{ and}\\
\vec{\xi}_{d,i}\pec
\eeanum
\end{subequations}
respectively?

We first consider the equivalence of $\overline{\overline{\mathbf R}}_{\sigma_{\tau,i}}$ to $\R{\widetilde{\Sigma_t}}$.
By definition, 
\benum
\overline{\overline{\mathbf R}}_{\sigma_{\tau,i}} = \frac{1}{a_{ii} c \Delta t} \M + \R{\sigma_t} \pep
\eenum
It follows that,
\beanum
\overline{\overline{\mathbf R}}_{\sigma_{\tau,i},jk} &=& \frac{1}{a_{ii} c \Delta t} \frac{\Delta x}{2} \int_{-1}^1{\B{j}(s) \B{k}(s) ~ds} + \frac{\Delta x}{2} \int_{-1}^1{ \sigma_t(s) \B{j}(s) \B{k}(s)~ds} \\
\overline{\overline{\mathbf R}}_{\sigma_{\tau,i},jk} &=& \frac{\Delta x}{2} \int_{-1}^1{ \left(\frac{1}{a_{ii} c \Delta t} + \sigma_t(s)  \right) \B{j}(s) \B{k}(s)~ds} \pep
\eeanum
From \eqts{eq:funky_defs},
\benum
\R{\widetilde{\Sigma_t},jk} = \frac{\Delta x}{2} \int_{-1}^1{\left( \frac{1}{a_{ii} \Delta t c} + \sigma_t(s) \right)\B{j}(s)\B{k}(s)~ds} \pec
\eenum
and we conclude that $\overline{\overline{\mathbf R}}_{\sigma_{\tau,i}} = \R{\widetilde{\Sigma_t}}$.
This is a very important result because it implies that we have a consistent definition of $\widetilde{\Sigma}_t$, which in turn allows us to define a diffusion coefficient for MIP DSA,
\benum
D(s) = \frac{1}{3\widetilde{\Sigma}_t(s)} = \frac{1}{3 \left( \frac{1}{a_{ii} c \Delta t} + \sigma_t(s) \right)} \pep
\eenum


 $\R{\widetilde{\Sigma}_{t,i}}$ be equivalent to $\overline{\overline{\mathbf{R}}}_{\sigma_{\tau,i}}$ of \eqt{eq:step_i_defs}?
Likewise, if we define
\beanum
\widetilde{\Sigma}_a &=& \widetilde{\Sigma}_t - \widetilde{\Sigma}_s \\
\widetilde{\Sigma}_a &=&  \sigma_{\tau,i} - \left(  \sigma_s + \nu_i \sigma_a \right) \pec
\eeanum
is the reaction matrix from the spatially analytic Planck linearization, $\R{\widetilde{\Sigma}_a}$, equal to the equivalent matrix arising from the Planck linearization of the discretized equations,
\benum
\R{\sigma_s} + \overline{\overline{\nu}}_i \R{\sigma_a} ~\text{?}
\eenum

We first consider the pseudo total interaction cross section.  If, after performing the spatially analytic linearization of the Planckia
\section{Computer Science Implementation}
\label{sec:chap6_programming}

\section{Numerical Results}
\label{sec:chap6_results}

\section{Conclusions}
\label{sec:chap6_conclusions}


