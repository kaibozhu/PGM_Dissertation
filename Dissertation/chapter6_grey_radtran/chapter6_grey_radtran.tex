%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
%  New template code for TAMU Theses and Dissertations starting Fall 2012.  
%  For more info about this template or the 
%  TAMU LaTeX User's Group, see http://www.howdy.me/.
%
%  Author: Wendy Lynn Turner 
%	 Version 1.0 
%  Last updated 8/5/2012
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                           SECTION III
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\chapter{\uppercase{Grey Thermal Radiative Transfer}}
\label{sec:chapter6_grey_radtran}

We now apply our self-lumping DFEM methodology to the grey thermal radiative transfer equations.
Our framework will share important characteristics of the work presented by Morel, Wareing, and Smith\cite{morel_radtran}.
That is, we will
\begin{enumerate}
\item linearize the Planckian about an arbitrary temperature,
\item  expand the angular intensity and temperature in a $P$ degree trial space, and
\item expand the spatial dependence of the Planckian in a $P$ degree trial space.
\end{enumerate}
There are several differences between the work we present here and that of \cite{morel_radtran}.
First, we will derive our method for arbitrary DFEM polynomial trial space degree, not only a linear polynomial trial space.
Second, \cite{morel_radtran} used a DFEM scheme equivalent to traditional lumping, whereas we will primarily be considering quadrature based self-lumping discretizations.
However, the equations we derive will be applicable to any DFEM scheme that uses polynomial trial and test functions.
Additionally, we will consider arbitrary order (and stage count) SDIRK integration, not only implicit Euler time integration.
The two most important differences between our work here and that of \cite{morel_radtran} will be that we will assume opacity can vary within each spatial cell and we will fully converge the Planckian linearization in temperature.
As shown by Larsen, Kumar, and Morel, failure to fully converge the Planckian linearization in temperature can result lead to non-physical solutions that violate the maximum principle\cite{larsen_trt}.

The remainder of this chapter will be divided into three sections.  Section \ref{sec:chap6_linearization} will describe our linearization and discretization of grey TRT equations.  
In \secref{sec:chap6_programming}, we will briefly describe the features and computer science implementation of the discretized TRT equations.  
Finally, we present numerical results that verify and demonstrate the capabilities of our TRT solver in \secref{sec:chap6_results} and discuss the results in \secref{sec:chap6_conclusions}.

\section{Linearization and Discretization of Grey TRT Equations}
\label{sec:chap6_linearization}
We will begin our discussion of how to linearize the Planckian of the grey thermal radiative transfer in temperature by first briefly outlining SDIRK temporal integration in \secref{sec:sdirk_explained}.
A more complete explanation can be found in \cite{alexander}

\subsection{SDIRK Time Integration}
\label{sec:sdirk_explained}
The coefficients, $a_i$, $b_i$, and $c_i$ that describe any Runge-Kutta time integration are typically given in formatted tables called Butcher Tableaux.
Due to the stiff nature of the TRT equations, we will limit ourselves to SDIRK time integration schemes.  
Depending on the source, SDIRK stands for Single-Diagonally Implicit Runge-Kutta, S-stable Diagonally Implicit Runge-Kutta, or one of many other expansions of the SDIRK acronym, depending on the source's author.
The Butcher Tableaux of an SDIRK  scheme with $N_{stage}$ stages is given in \eqt{eq:butcher}
\benum
\label{eq:butcher}
\begin{array}{c|c|cccc}
\text{Stage}& c_i 	 & a  			&  		&					&	\\
\hline
1						&  c_1   &  a_{11} 	&  0  	&		\dots		&  0 \\
2						&  c_2   &  a_{21}  & a_{22}  & 		0		& \vdots	\\	
i						& c_i    &   a_{i1} &  a_{i2} & \ddots   &	0	\\
N_{stage}     			&  c_{N_{stage}}   &   a_{N_{stage}1} & a_{N_{stage}2} 	& \dots 		& a_{N_{stage}N_{stage} }\\
\hline
{}					&				&		b_1		&		b_2			& \dots 	&   b_{N_{stage}}
\end{array} \pep
\eenum
To illustrate how SDIRK is used to advance time dependent quantities, let us consider a time dependent scalar function, $g(t)$.
Given an initial value at time (or time step) $t^n$, $g_n = g(t^n)$, then $g(t^{n+1})$ is:
\benum
g_{n+1} = g_n + \Delta t \sum_{i=1}^{N_{tstage}}{b_i k_i} \pec
\label{eq:p1}
\eenum
where $\Delta t = t^{n+1} - t^n$, and $k_i$ is defined as:
\benum
k_i = f\left( t_n + c_i \Delta t ~,~g_{n} + \Delta t \sum_{j=1}^i{c_{ij} k_j }\right) \pec
\eenum
and
\benum
f(t,g) = \frac{\partial g}{\partial t} \pep
\eenum
Equation \ref{eq:p1} can also be interpreted as meaning:
\benum
g_i = g_{n} + \Delta t \sum_{j=1}^i{a_{ij} f\left(t_n + \Delta t c_j , g_j\right)} \pec
\label{eq:psi-def}
\eenum
where $g_i$ is the intermediate value of $g$ at the time of stage $i$, $t_i = t^n + \Delta t c_i$.

\subsection{Spatially Analytic Linearization}
%
%
We now linearize the spatially analytic, 1-D slab, grey, discrete ordinates TRT equations with SDIRK time integration.  The fully analytic grey TRT are given in \eqts{eq:analytic_grey_trt},
\begin{subequations}
\label{eq:analytic_grey_trt}
\benum
\frac{1}{c} \frac{\partial I}{\partial t} + \mu_d \frac{\partial I}{\partial x} + \sigma_t I= \frac{1}{4\pi}\sigma_s \phi + \sigma_a B + S_I
\label{eq:intensity_eq}
\eenum
\benum
C_v \frac{\partial T}{\partial t} = \sigma_a \left( \phi - 4\pi B \right) + S_T \pep
\label{eq:temperature_eq} 
\eenum
\end{subequations}
In \eqts{eq:analytic_grey_trt}, we have assumed all scattering and material photon emission is isotropic, assume that $I$ is the intensity with directional cosine $\mu_d$ (relative to the $x$-axis),  $S_I$ is a homogenous intensity source in the direction of $\mu_d$, $S_T$ is a homogenous temperature source, and the frequency integrated Planck, $B$ is:
\benum
B(T) = \frac{1}{4\pi} ac T^4\pec
\eenum
with $c$ as the speed of light, and $a$ is the Planck radiation constant.
To use SDIRK to advance $I$ and $T$ in time, we must first define the time derivatives of $I$ and $T$:
\benum
 \frac{\partial I}{\partial t} = c\left[ \frac{1}{4\pi}\sigma_s \phi + \sigma_a B + S_I - \mu_d \frac{\partial I}{\partial x} - \sigma_t I \right]
\label{eq:k_I}
\eenum
and
\benum
\frac{\partial T}{\partial t} = \frac{1}{C_v} \left[ \sigma_a \left( \phi - 4\pi B \right) + S_T \right] \pep
\label{eq:k_T}
\eenum
We evaluate $k_{I,s}$ and $k_{T,s}$, the SDIRK $k$ values for intensity and temperature for stage $s$ as:
\benum
k_{I,s} = c\left[ \frac{1}{4\pi}\sigma_{s}(T_s) \phi_s + \sigma_a(T_s) B(T_s) + S_I(t_s) - \mu_d \frac{\partial I_s}{\partial x} - \sigma_t(T_s) I_s \right]
\label{eq:k_I_stage}
\eenum
and
\benum
k_{T,s} = \frac{1}{C_v(T_s)} \left[ \sigma_a(T_s) \left( \phi_s - 4\pi B(T_s) \right) + S_T(t_s) \right] \pec
\label{eq:k_T_stage}
\eenum
where $\phi_s$, $I_s$, and $T_s$ are the angle integrated intensity, angular intensity, and temperature at stage/time $s$.

\subsubsection{SDIRK Stage 1}
With the definitions of \eqt{eq:psi-def}, \eqt{eq:k_I_stage}, and \eqt{eq:k_T_stage}, we now seek to find $I_1$,
\benum
I_1 = I_n + a_{11} \Delta t k_{I,1} \pec
\eenum
after substituting the definition of \eqt{eq:k_I_stage}
\benum
I_1 = I_n + a_{11} \Delta t c \left[ \frac{1}{4\pi}\sigma_{s} \phi_1 + \sigma_a B+ S_I - \mu_d \frac{\partial I_1}{\partial x} - \sigma_t I_1 \right] 
\pep
\label{eq:i_1_start}
\eenum
Likewise for $T_1$, we have
\benum
T_1 = T_n +\frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi B \right) + S_T  \right] \pep
\label{eq:t_1_start}
\eenum
In \eqt{eq:i_1_start} and \eqt{eq:t_1_start}, we have assumed that unless otherwise noted, all material properties and sources are evaluated at $t_s$ and $T_s$.

We now introduce the linearization of the Planckian in temperature. 
For an arbitrary temperature iterate, $T_*$, we approximate $B(T_s)$ as:
\beanum
B(T) &\approx & B(T_*) + \frac{\partial B}{\partial T} \bigg \lvert_{T=T_*} \left(  T - T_* \right) \\
B(T) &\approx & B_* + D_*  \left(  T - T_* \right) \\
D_* &=& \frac{1}{\pi} a cT_*^3 \pep
\label{eq:scalar_linear}
\eeanum
If we could remove the dependence on $T_1$ from \eqt{eq:i_1_start}, we could solve \eqt{eq:i_1_start} using the same techniques that have been developed to solve the discrete ordinates neutron transport equation.
To remove the dependence on $T_1$ from \eqt{eq:i_1_start}, we first insert the linearization of \eqt{eq:scalar_linear} into \eqt{eq:t_1_start} and manipulate.
We begin with \eqt{eq:long_t_1}
\benum
T_1 = T_n + \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi \left(  B_* + D_*  \left(  T_1 - T_* \right)  \right) \right) + S_T  \right] \pec
\label{eq:long_t_1}
\eenum
then move all $T_1$ terms to the left hand side,
\benum
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)T_1 = T_n + \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi   B_* + 4\pi D_*  T_* \right) + S_T  \right] \pep
\eenum
In \eqt{eq:long_t_1}, we have made the assumption that all material properties are evaluated at $T_*$, but will neglect to denote this for simpler notation.
Next, we divide by the coefficient in front of $T_1$ on the left hand side:
\begin{multline}
T_1 = \left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} T_n + \dots \\
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi   B_* \right) + S_T \right] + \dots \\
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{ 4\pi a_{11} \Delta t }{C_v} \sigma_a D_*  T_* \pec
\end{multline}
and then add ``nothing'' ,
\benum
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_* - T_* \right) \pec
\eenum
to the right hand side,
\begin{multline}
T_1 = \left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} T_n + \dots \\
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi   B_* \right) + S_T \right] + \dots \\
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left(1 + \frac{ 4\pi a_{11} \Delta t }{C_v} \sigma_a D_* \right) T_* \dots \\
-\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} T_*\pep
\end{multline}
Noting that 
\benum
\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left(1 + \frac{ 4\pi a_{11} \Delta t }{C_v} \sigma_a D_* \right)  = 1 \pec
\eenum
and condensing, we finally have:
\benum
T_1 = T_* + \left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n - T_* + \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi   B_* \right) + S_T \right]  \right) \pep
\label{eq:analytic_t_1}
\eenum
We will occasionally refer to \eqt{eq:analytic_t_1} as a temperature update, as \eqt{eq:analytic_t_1} is the non-linear iteration for temperature we wish to converge.

We now linearize the Planck term in \eqt{eq:i_1_start},
\benum
I_1 = I_n + a_{11} \Delta t c \left[ \frac{1}{4\pi}\sigma_{s} \phi_1 + \sigma_a \left(B_* + D_*(T_1 - T_*)  \right) + S_I - \mu_d \frac{\partial I_1}{\partial x} - \sigma_t I_1 \right] \pep
\label{eq:long_i_1_analytic}
\eenum
We then insert \eqt{eq:analytic_t_1} into \eqt{eq:long_i_1_analytic},
\begin{multline}
I_1 = I_n + a_{11} \Delta t c \left[ \frac{1}{4\pi}\sigma_{s} \phi_1 + S_I - \mu_d \frac{\partial I_1}{\partial x} - \sigma_t I_1  \right. \\ 
\left. + \sigma_a \left(B_* + D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n - T_* + \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi   B_* \right) + S_T \right]  \right) \right) \right] \pep
\end{multline}
Next, we divide by $ a_{11} \Delta t c$, and move interaction and gradient terms to the left hand side:
\begin{multline}
\mu_d \frac{\partial I_1}{\partial x} + \sigma_t I_1 + \frac{1}{a_{11} \Delta t c} I_1 = \frac{1}{a_{11} \Delta t c}I_n + \frac{1}{4\pi}\sigma_{s} \phi_1 + S_I \dots \\
+ \sigma_a \left(B_* + D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n - T_* + \frac{a_{11} \Delta t }{C_v} \left[ \sigma_a \left( \phi_1 - 4\pi   B_* \right) + S_T \right]  \right) \right) \pep
\end{multline}
We now manipulate the right hand side,
\begin{multline}
\mu_d \frac{\partial I_1}{\partial x} + \sigma_t I_1 + \frac{1}{a_{11} \Delta t c} I_1 = \frac{1}{a_{11} \Delta t c}I_n + \frac{1}{4\pi}\sigma_{s} \phi_1  \dots \\ 
+  \sigma_a  D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{11} \Delta t }{C_v} \sigma_a \phi_1  \dots \\
+ S_I + \sigma_a B_* 
+ \sigma_a D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n - T_* + \frac{a_{11} \Delta t }{C_v} \left[  S_T - 4\pi \sigma_a   B_*\right]  \right) \pec
\end{multline}
and define
\benum
\sigma_{\tau,1} = \sigma_t + \frac{1}{a_{11} \Delta t c} \pec
\label{eq:tau_1_analytic}
\eenum
giving
\begin{multline}
\mu_d \frac{\partial I_1}{\partial x} + \sigma_{\tau,1} I_1 = \frac{1}{a_{11} \Delta t c}I_n + \frac{1}{4\pi}\sigma_{s} \phi_1  \dots \\ 
+  \sigma_a  D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{11} \Delta t }{C_v} \sigma_a \phi_1  \dots \\
+ S_I + \sigma_a B_* 
+ \sigma_a D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n - T_* + \frac{a_{11} \Delta t }{C_v} \left[  S_T - 4\pi \sigma_a   B_*\right]  \right) \pep
\end{multline}
Focusing on the second $\phi_1$ term on the right hand side,
\benum
\sigma_a  D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{11} \Delta t }{C_v} \sigma_a \phi_1 \pec
\eenum
multiplying by $\frac{4\pi}{4\pi}$ we have:
\benum
\frac{1}{4\pi} \left( 4\pi  a_{11} \Delta t \sigma_a  D_*  \right) \left(C_v + 4\pi a_{11} \Delta t \sigma_a D_*  \right)^{-1}\sigma_a \phi_1 \pec
\eenum
and defining a constant, $\nu_1$,
\benum
\nu_1 = \left( 4\pi  a_{11} \Delta t \sigma_a  D_*  \right) \left(C_v + 4\pi a_{11} \Delta t \sigma_a D_*  \right)^{-1} \pec
\eenum
we arrive at an equation for intensity $I_1$ that appears like a neutron transport with isotropic scattering, fission, and a fixed source:
\benum
\mu_d \frac{\partial I_1}{\partial x} + \sigma_{\tau,1} I_1 = \frac{1}{4\pi}\sigma_{s} \phi_1 + \frac{1}{4\pi}\nu_1 \sigma_a \phi_1 + \xi_1 \pec
\label{eq:i_analytic_pseudo}
\eenum
where
\begin{multline}
\xi_1 = \frac{1}{a_{11} \Delta t c}I_n + S_I + \sigma_a B_* + \dots \\
\sigma_a D_*\left(1 + \frac{4\pi a_{11} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n - T_* + \frac{a_{11} \Delta t }{C_v} \left[  S_T - 4\pi \sigma_a   B_*\right]  \right) \pep
\end{multline}
If we define pseudo total interaction and scattering cross sections, $\widetilde{\Sigma_t}$ and $\widetilde{\Sigma_s}$, to be
\beanum
\widetilde{\Sigma_t} &=& \sigma_{\tau,1} \\
\widetilde{\Sigma_s} &=& \sigma_s + \nu_1 \sigma_a\pec
\eeanum
and a pseudo absorption interaction cross section as,
\benum
\widetilde{\Sigma_a}  = \widetilde{\Sigma_t} - \widetilde{\Sigma_s} \pec
\eenum
then it appears that all of the methodology, including DSA, developed for discrete ordinates neutron transport might be applicable for solving the discrete ordinates thermal radiative transfer equations using SDIRK time integration.
The next step in examining the possibility of applying neutron transport methods to solve the TRT equations is to attempt to form a pseudo neutron transport equation for stage $i$ of any SDIRK time integration scheme. 

\subsubsection{SDIRK Stage $i$}

The intensity at stage $i$, $t=t_n + c_i \Delta t$, is given by:
\benum
I_i = I_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{I,j}} + a_{ii} \Delta t c \left[ \frac{1}{4\pi}\sigma_{s} \phi_i + \sigma_a \left[B_* + D_* (T_i - T_*) \right]+ S_I - \mu_d \frac{\partial I_i}{\partial x} - \sigma_t I_i \right] 
\pep
\label{eq:i_i_start}
\eenum
Likewise for $T_i$, we have
\benum
T_i = T_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} + \frac{a_{ii} \Delta t }{C_v} \left[ \sigma_a \left( \phi_i - 4\pi \left[ B_* + D_*(T_i - T_*) \right] \right) + S_T  \right] \pep
\label{eq:analytic_t_i_start}
\eenum
Proceeding as for SDIRK stage 1, we work to move all $T_i$ terms of \eqt{eq:analytic_t_i_start} to the left hand side,
\benum
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)T_i = T_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}}  + \frac{a_{ii} \Delta t }{C_v} \left[ \sigma_a \left( \phi_i - 4\pi   B_* + 4\pi D_*  T_* \right) + S_T  \right] \pep
\eenum
Next, we divide by the coefficient in front of $T_i$ on the left hand side:
\begin{multline}
T_i = \left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} \right) + \dots \\
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{ii} \Delta t }{C_v} \left[ \sigma_a \left( \phi_i- 4\pi   B_* \right) + S_T \right] + \dots \\
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{ 4\pi a_{ii} \Delta t }{C_v} \sigma_a D_*  T_* \pec
\end{multline}
and then add ``nothing'' ,
\benum
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_* - T_* \right) \pec
\eenum
to the right hand side,
\begin{multline}
T_i = \left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left( T_n + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} \right) + \dots \\
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \frac{a_{ii} \Delta t }{C_v} \left[ \sigma_a \left( \phi_i - 4\pi   B_* \right) + S_T \right] + \dots \\
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left(1 + \frac{ 4\pi a_{ii} \Delta t }{C_v} \sigma_a D_* \right) T_* \dots \\
-\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} T_*\pep
\end{multline}
Noting that 
\benum
\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \left(1 + \frac{ 4\pi a_{ii} \Delta t }{C_v} \sigma_a D_* \right)  = 1 \pec
\eenum
and condensing, we have:
\begin{multline}
T_i = T_* + \left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} \\
\left( T_n - T_* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} +  \frac{a_{ii} \Delta t }{C_v} \left[ \sigma_a \left( \phi_i - 4\pi   B_* \right) + S_T \right]  \right) \pep
\label{eq:analytic_t_i}
\end{multline}
Inserting \eqt{eq:analytic_t_i} into \eqt{eq:i_i_start}, dividing by $a_{ii} c \Delta t$, and moving the gradient and interaction terms to the left hand side:
\begin{multline}
\mu_d \frac{\partial I_i}{\partial x} + \left(\frac{1}{a_{ii} \Delta t c} + \sigma_t \right) I_i = \frac{1}{a_{ii} \Delta t c} I_n + \frac{1}{a_{ii} c} \sum_{j=1}^{i-1}{a_{ij} k_{I,j}} + \dots\\
\frac{1}{4\pi}\sigma_{s} \phi_i + \sigma_a B_* + S_I \dots \\
 + \sigma_a D_*\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} 
\left( T_n - T_* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} \right) \dots \\
+   \sigma_a D_*\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1}  \frac{a_{ii} \Delta t }{C_v} \left[ \sigma_a \left( \phi_i - 4\pi   B_* \right) + S_T \right]  \pep
\end{multline}
Isolating the $\phi_i$ term that has a coefficient based on the Planck linearization:
\begin{multline}
\mu_d \frac{\partial I_i}{\partial x} + \left(\frac{1}{a_{ii} \Delta t c} + \sigma_t \right) I_i = \frac{1}{a_{ii} \Delta t c} I_n + \frac{1}{a_{ii} c} \sum_{j=1}^{i-1}{a_{ij} k_{I,j}} + \dots\\
\frac{1}{4\pi}\sigma_{s} \phi_i + \sigma_a B_* + S_I \dots \\
 + \sigma_a D_*\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} 
\left( T_n - T_* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} +   \frac{a_{ii} \Delta t }{C_v}  \left( S_T -  4\pi  \sigma_a B_*   \right) \right) \dots \\
+   \sigma_a D_*\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1}  \frac{a_{ii} \Delta t }{C_v} \sigma_a  \phi_i  \pec
\end{multline}
defining 
\benum
\nu_i = 4\pi \sigma_a D_* \left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1}  \frac{a_{ii} \Delta t }{C_v} = \frac{ 4\pi a_{ii} \sigma_a D_*}{C_v + 4\pi a_{ii} \Delta t  \sigma_a D_*} \pec
\eenum
and
\begin{multline}
\xi_i = \sigma_a B_* + S_I +  \frac{1}{a_{ii} \Delta t c} I_n + \frac{1}{a_{ii} c} \sum_{j=1}^{i-1}{a_{ij} k_{I,j}}  + \dots  \\ 
\sigma_a D_*\left(1 + \frac{4\pi a_{ii} \Delta t}{C_v} \sigma_a D_*  \right)^{-1} 
\left( T_n - T_* + \Delta t \sum_{j=1}^{i-1}{a_{ij} k_{T,j}} +   \frac{a_{ii} \Delta t }{C_v}  \left( S_T -  4\pi  \sigma_a B_*   \right) \right) \pec
\end{multline}
we arrive at another equation that appears to be similar to the neutron transport equation with isotropic scattering, a fission source, and a fixed source:
\benum
\mu_d \frac{\partial I_i}{\partial x} + \sigma_{\tau,i} = \frac{1}{4\pi} \sigma_s \phi_i + \frac{1}{4\pi}\nu_i \sigma_a \phi_i + \xi_i \pep
\label{eq:analytic_pseudo_i}
\eenum
In the spatially analytic case, the grey TRT equations, with Planck linearization and arbitrary stage count SDIRK time integration can be put into a pseudo neutron transport form.
This suggests that we may techniques such as spatial discretization and acceleration methods, can be used to solve the grey TRT equations.
Since we will go through the entire linearization procedure with the spatially discretized grey TRT equations in the next section, it may seem unnecessary to have performed the preceding  for the spatially analytic case.

If we could solve the spatially discretized equations efficiently through source iteration alone, it would be redundant to linearize the the spatially analytic and spatially discretized TRT equations.
However, iterative acceleration is essential for efficient solution of the TRT equations due to the Planckian absorption/re-emission terms in the linearized radiation intensity equation creating a situation analogous to a scattering dominated medium in neutron transport.
As we will see, the problem with accelerating the spatially discretized TRT equations is that we will need a pseudo diffusion coefficient, $\widetilde{D}$, both at quadrature integration points and cell edges for MIP DSA acceleration.
While we will still define,
\benum
\widetilde{D} = \frac{1}{3\widetilde{\Sigma}_t} \pec
\eenum
we will only have guaranteed integral information about $\widetilde{\Sigma}_t$ coming from a pseudo reaction matrix, $\mathbf{R}_{\widetilde{\Sigma}_t}$.

\subsection{Spatially Discretized Linearization}
Now we will attempt to derive a pseudo fission form of the spatially discretized grey TRT equations.
First, we must define a spatially discretized $k_I$ and $k_T$.
To do this, we apply the standard Galerkin procedure outlined in \chapref{sec:chapter2_constant_xs} and \chapref{sec:chapter3_varaible_xs} to the spatially analytic forms of $k_{I}$ and $k_{T}$ given in \eqt{eq:k_I_stage} and \eqt{eq:k_T_stage}, respectively.
For $\vec{k}_{I}$, we have:
\benum
\vec{k}_{I}= c \M^{-1} 
\left[
\frac{1}{4\pi}\R{\sigma_s}\vec{\phi} + \R{\sigma_a}\vec{B} - \R{\sigma_t} \vec{I} - \mathbf{G}\vec{I} + \vec{f}I_{in} + \vec{S}_I
\right] \pec
\eenum
where we have approximated the true angular intensity, angle integrated intensities, and temperatures as $P$ degree polynomials:
\beanum
I(s) &\approx& \widetilde{I}(s) \\
\widetilde{I}(s) &=& \sum_{i=1}^{N_P}{ I_i \B{i}(s) } \\
\phi(s) &\approx& \widetilde{\phi(s) }\\
\widetilde{\phi}(s) &=& \sum_{i=1}^{N_P}{ \phi_i \B{i}(s) } \\
T(s) &\approx& \widetilde{T}(s) \\
\widetilde{I}(s) &=& \sum_{i=1}^{N_P}{T_i \B{i}(s) } \pec
\eeanum
with
\beanum
\vec{I} &=& \left[  I_1 \dots I_{N_P} \right]^T \\
\vec{\phi} &=&\left[  \phi_1 \dots \phi_{N_P} \right]^T \\
\vec{T} &=& \left[  T_1 \dots T_{N_P} \right]^T \\
\vec{B} &=& \frac{1}{4\pi} \left[  B(T_1) \dots B(T_{N_P}) \right]^T \pec
\eeanum
and
\benum
\vec{S}_{I,j} = \frac{\Delta x}{2}\int_{-1}^1{\B{j}(s) S_I(s) ~ds} \pep
\eenum
Additionally, $\R{\sigma_t}$ , $\R{\sigma_a}$, and $\R{\sigma_s}$, are defined analogously to the $\R{\Sigma}$ defined for neutron transport, as are $\mathbf{G}$, $\mathbf{M}$, and $\vec{f}$.
Defining $\vec{k}_T$:
\benum
\vec{k}_T =  \R{C_v}^{-1}
\left[ \R{\sigma_a} \left(\vec{\phi} - 4\pi\vec{B} \right) + \vec{S}_T \right] \pec
\label{eq:k_t_discretized}
\eenum
with
\benum
\vec{S}_{T,j} = \frac{\Delta x}{2}\int_{-1}^1{\B{j}(s) S_T(s) ~ds} \pec
\eenum
and
\benum
\mathbf{R}_{C_v,ij} = \int_{-1}^1{C_v(s) \B{i}(s)\B{j}(s)~ds} \pep
\eenum

\subsubsection{SDIRK Stage 1}
We now write down the spatially discretized, grey TRT equations with a Planckian that has been linearized in temperature, for the first SDIRK stage.
\benum
\vec{I}_1 = \vec{I}_n + c\Delta t a_{11}\M^{-1}\left[   
\frac{1}{4\pi}\R{\sigma_s,*}\vec{\phi}_1 + \R_{\sigma_a,*}\left(\Pvec + \D \left(\vec{T}_1 -\vec{T}^*  \right)   \right)- \R_{\sigma_t,*} \vec{I}_1 - \mathbf{L}\vec{I}_1 + \vec{f}I_{in,1} 
+ \vec{S}_I
\right]
\label{eq:first_I}
\eenum
\benum
\vec{T}_1  = \vec{T}_n + \Delta t a_{11} \R_{C_v}^{-1}\left[
\R_{\sigma_a} \left(\vec{\phi}_1 - 4\pi\Pvec - 4\pi\D\left( \vec{T}_1 - \vec{T}^* \right)\right) + \vec{S}_T
\right]
\label{eq:first_T}
\eenum
In \eqt{eq:first_I}, \eqt{eq:first_T}, and all of the equations that follow, we will evaluate all material properties ($\sigma$, $C_v$) at $\widetilde{T}_*$.
It is our opinion that this required to have a truly implicit scheme, though Larsen noted that maximum preserving solution can still be achieved for other, not fully implicit treatments of material properties.
We now use \eqt{eq:first_T} to eliminate the unknown temperature, $\vec{T}_1$ from \eqt{eq:first_I}. Solving \eqt{eq:first_T} for $\vec{T}_1$:
\be
\vec{T}_1 +  4\pi\Delta t a_{11} \R_{C_v}^{-1}\R_{\sigma_a}\D \vec{T}_1   = \vec{T}_n + \Delta t a_{11} \R_{C_v}^{-1}\left[
\R_{\sigma_a*} \left(\vec{\phi}_1 -  4\pi\Pvec+ 4\pi\D\vec{T}^* \right) + \vec{S}_T
\right]
\ee
\begin{multline*}
\vec{T}_1 = \left[\mathbf{I} + 4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a}\D   \right]^{-1}
\left[
\vec{T}_n + \Delta t a_{11}  \R_{C_v}^{-1}\left[ \R_{\sigma_a} \left(\vec{\phi}_1 -4\pi \Pvec+ 4\pi\D\vec{T}^* \right) +  \vec{S}_T \right]  
\right] \dots \\ + \left[\I+ 4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a}\D   \right]^{-1}\left[\vec{T}^* - \vec{T}^*  \right]
\end{multline*}
%
%
\begin{multline*}
\vec{T}_1 = \left[\I+ 4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a}\D   \right]^{-1}
\left[
\vec{T}_n + \Delta t a_{11}  \R_{C_v}^{-1}\left[ \R_{\sigma_a*} \left(\vec{\phi}_1 - 4\pi\Pvec  \right)+ \vec{S}_T \right]\right] \dots \\ 
+ 
\left[\I +  4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a}\D  \right]^{-1}
\left[\I +  4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a}\D   \right] \vec{T}^* \dots \\
- \left[\I +  4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a}\D   \right]^{-1}\vec{T}^*
\end{multline*}
%
%finished the above
%
%
The ``Temperature Update'' for the first RK stage is the following:
%
\benum
\vec{T}_1 = \vec{T}^* + \left[\I + 4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a}\D \right]^{-1}\left[\vec{T}_n - \vec{T}^* +  \Delta t a_{11}  \R_{C_v}^{-1}\left[ \R_{\sigma_a*} \left(\vec{\phi}_1 - 4\pi\Pvec\right) + \vec{S}_{T}\right]\right]
\label{eq:iso_T1}
\eenum
%
%
Inserting \eqt{eq:iso_T1} into \eqt{eq:first_I}:
\begin{multline*}
\vec{I}_1 = \vec{I}_n + c\Delta t a_{11}\M^{-1}\left[   
\frac{1}{4\pi}\R_{\sigma_s,*}\vec{\phi}_1 + \R_{\sigma_a,*}\Pvec - \R_{\sigma_t,*} \vec{I}_1 -\mathbf{ L}\vec{I}_1 + \vec{f}I_{in,1} + \vec{S}_I \right] \dots  \\
+ c \Delta t a_{11}\M^{-1} \R_{\sigma_a,*}\D
\left[\I + 4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a}\D   \right]^{-1}
\left[\vec{T}_n - \vec{T}^* +  \Delta t a_{11} \R_{C_v}^{-1}\left[ \R_{\sigma_a*} \left(\vec{\phi}_1 - 4\pi\Pvec\right) + \vec{S}_T \right]\right] 
\end{multline*}
%
%
%
Multiply by $\frac{1}{c\Delta t a_{11}}\M$
\begin{multline*}
\frac{1}{c\Delta t a_{11}}\M\vec{I}_1 = \frac{1}{c\Delta t a_{11}}\M\vec{I}_n + \left[   
\frac{1}{4\pi}\R_{\sigma_s,*}\vec{\phi}_1 + \R_{\sigma_a,*}\Pvec - \R_{\sigma_t,*} \vec{I}_1 - \mathbf{ L}\vec{I}_1 + \vec{f}I_{in,1}  + \vec{S}_I \right] \dots  \\
+ \R_{\sigma_a,*} \D
\left[\I+ 4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a*}\D   \right]^{-1}
\left[\vec{T}_n - \vec{T}^* +  \Delta t a_{11} \R_{C_v}^{-1}\left[ \R_{\sigma_a*} \left(\vec{\phi}_1 - 4\pi\Pvec\right) + \vec{S}_T\right]\right]  \pep
\end{multline*}
%
%
%
Move some terms over to the LHS:
\begin{multline*}
\mathbf{ L}\vec{I}_1 + \left(\frac{1}{c\Delta t a_{11}} \M + \R_{\sigma_t,*} \right)\vec{I}_1 = \frac{1}{c\Delta t a_{11}}\M\vec{I}_n +   
\frac{1}{4\pi}\R_{\sigma_s,*}\vec{\phi}_1 + \R_{\sigma_a,*}\Pvec + \vec{f}I_{in,1} + \vec{S}_I \dots  \\
+ \R_{\sigma_a,*} \D \left[\I+ 4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a*}\D   \right]^{-1}
\left[\vec{T}_n - \vec{T}^* +  \Delta t a_{11}  \R_{C_v}^{-1}\left[ \R_{\sigma_a*} \left(\vec{\phi}_1 - 4\pi\Pvec\right) + \vec{S}_T\right]\right] 
\end{multline*}
%
%above here
%
Further manipulating to pull all of the $\vec{\phi}_1$ terms together:
%
%
\begin{multline}
\mathbf{ L}\vec{I}_1 + \left(\frac{1}{c\Delta t a_{11}} \M + \R_{\sigma_t,*} \right)\vec{I}_1 = \dots \\
\frac{1}{4\pi}\R_{\sigma_s,*}\vec{\phi}_1 + \Delta t a_{11} \R_{\sigma_a,*} \D
\left[\I + 4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a*} \D   \right]^{-1}
  \R_{C_v}^{-1}\R_{\sigma_a*}
\vec{\phi}_1 \dots \\
+ \frac{1}{c\Delta t a_{11}}\M\vec{I}_n +\R_{\sigma_a,*}\Pvec + \vec{f}I_{in,1} \vec{S}_I  \dots \\
+ \R_{\sigma_a,*} \D
\left[\I +4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a*} \D   \right]^{-1}
\left[\vec{T}_n - \vec{T}^* + \Delta t a_{11}  \R_{C_v}^{-1}\left[ \vec{S}_T -4\pi\R_{\sigma_a*} \Pvec\right] \right] 
\label{eq:almost_1}
\end{multline}
Though it does not look that familiar, \eqt{eq:almost_1} can be made to resemble the canonical mono-energetic neutron fission equation.  Let us define the following terms:
\begin{subequations}
\label{eq:step1_defs}
\benum
\bar{\bar{\mathbf \nu}} = 4\pi\Delta t a_{11} \R_{\sigma_a,*}
\D \left[\mathbf{I} + 4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a*}\D   \right]^{-1}\R_{C_v}^{-1}
\eenum
 %
 %
 \begin{multline}
\bar{\bar{\mathbf \xi}}_d = \frac{1}{c\Delta t a_{11}}\M\vec{I}_n + \R_{\sigma_a,*}\Pvec  + \vec{S}_I \dots \\ 
+ \R_{\sigma_a,*}
\D
\left[\I + 4\pi\Delta t a_{11}  \R_{C_v}^{-1}\R_{\sigma_a*}\D   \right]^{-1}
\left[\vec{T}_n - \vec{T}^* + \Delta t a_{11}  \R_{C_v}^{-1}\left[\vec{S}_T - 4\pi\R_{\sigma_a}\Pvec\right]\right] 
\end{multline}
%
\benum
\bar{\bar{\mathbf R}}_{\sigma_t} = \frac{1}{c\Delta t a_{11}} \M + \R_{\sigma_t,*}
\eenum
\end{subequations}
Inserting \eqts{eq:step1_defs} into \eqt{eq:almost_1} gives our final form:
\benum
 \mathbf{ L}\vec{I}_1 + \bar{\bar{\mathbf R}}_{\sigma_t}\vec{I}_1 = \frac{1}{4\pi}\R_{\sigma_s,*}\vec{\phi}_1 + \frac{1}{4\pi}\bar{\bar{\mathbf \nu}}\R_{\sigma_a*} \vec{\phi}_1 +  \vec{f}I_{in,1} + \bar{\bar{\mathbf \xi}}_d
\label{eq:1_done}
\eenum


\subsubsection{SDIRK Stage $i$}

\section{Computer Science Implementation}
\label{sec:chap6_programming}

\section{Numerical Results}
\label{sec:chap6_results}

\section{Conclusions}
\label{sec:chap6_conclusions}


